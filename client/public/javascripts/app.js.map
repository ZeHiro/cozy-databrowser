{"version":3,"file":"public/javascripts/app.js","sources":["app/application.coffee","app/collections/doctype_collection.coffee","app/collections/result_collection.coffee","app/initialize.coffee","app/lib/app_helpers.coffee","app/lib/base_view.coffee","app/lib/view.coffee","app/lib/view_collection.coffee","app/models/doctype_model.coffee","app/models/result_model.coffee","app/router.coffee","app/views/doctype_collection_view.coffee","app/views/doctype_view.coffee","app/views/doctypes_view.coffee","app/views/nav_view.coffee","app/views/result_collection_view.coffee","app/views/result_view.coffee","app/views/search_view.coffee","app/views/templates/doctype.jade","app/views/templates/doctypes.jade","app/views/templates/modal_confirm.jade","app/views/templates/result.jade","app/views/templates/search.jade"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAXA;;A,CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAnBA;;A,CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAzBA;;A,CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AARA;;A,CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAxEA;;A,CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA5CA;;A,CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAvCA;;A,CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA/GA;;A,CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAjBA;;A,CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA9BA;;A,CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAzDA;;A,CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAjCA;;A,CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAzDA;;A,CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AArBA;;A,CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA5CA;;A,CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA9GA;;A,CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAjKA;;A,CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAnDA;;A,CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAnDA;;A,CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AARA;;A,CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AARA;;A,CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAlCA;;A,CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AARA;;A","sourcesContent":["module.exports =\n\n    initialize: ->\n        # Used in inter-app communication\n        #SocketListener = require '../lib/socket_listener'\n\n        # Routing management\n        Router = require 'router'\n        @router = new Router()\n        Backbone.history.start()\n\n        # Makes this object immuable.\n        Object.freeze this if typeof Object.freeze is 'function'","module.exports = class DoctypeCollection extends Backbone.Collection\n\tmodel: require '../models/doctype_model'\n\turl: 'doctypes'","module.exports = class ResultCollection extends Backbone.Collection\t\n\tmodel: require '../models/result_model' \t\n\turl: () ->\n\t\treturn 'search?page=' + @page + '&nbperpage=' + @nbPerPage\n\tpage : 1\n\tnbPerPage : 10\n","app = require 'application'\n\n# The function called from index.html\n$ ->\n    require 'lib/app_helpers'\n\n    app.initialize()","(() ->\n    # IIFE to avoid collisions with other variables\n    (->\n        # Make it safe to do console.log() always.\n        console = window.console = window.console or {}\n        method = undefined\n        dummy = ->\n        methods = ('assert,count,debug,dir,dirxml,error,exception,\n                   group,groupCollapsed,groupEnd,info,log,markTimeline,\n                   profile,profileEnd,time,timeEnd,trace,warn').split ','\n\n        console[method] = console[method] or dummy while method = methods.pop()\n    )()  \n)()\n  # Initialize Spin JS the lib that displays loading indicators\n(() ->\n    $.fn.spin = (opts, color) ->\n        presets =\n            tiny:\n                lines: 8\n                length: 2\n                width: 2\n                radius: 3\n\n            small:\n                lines: 8\n                length: 1\n                width: 2\n                radius: 5\n\n            large:\n                lines: 10\n                length: 8\n                width: 4\n                radius: 8\n\n        if Spinner\n            @each ->\n                $this = $(this)\n                spinner = $this.data(\"spinner\")\n                if spinner?\n                    spinner.stop()\n                    $this.data \"spinner\", null\n                else if opts isnt false\n                    if typeof opts is \"string\"\n                        if opts of presets\n                            opts = presets[opts]\n                        else\n                            opts = {}\n                        opts.color = color if color\n                    spinner = new Spinner(\n                        $.extend(color: $this.css(\"color\"), opts))\n                    spinner.spin(this)\n                    $this.data \"spinner\", spinner\n\n        else\n            console.log \"Spinner class not available.\"\n            null\n)()","module.exports = class BaseView extends Backbone.View\n\n    template: ->\n\n    initialize: ->\n\n    getRenderData: ->\n        model: @model?.toJSON()\n\n    render: ->\n        @beforeRender()\n        @$el.html @template(@getRenderData())\n        @afterRender()\n        @\n\n    beforeRender: ->\n\n    afterRender: ->\n\n    destroy: ->\n        @undelegateEvents()\n        @$el.removeData().unbind()\n        @remove()\n        Backbone.View::remove.call @","module.exports = class View extends Backbone.View\n\n    template: ->\n\n    initialize: ->\n\n    render: (templateOptions) ->\n        @beforeRender()\n        render =  @template().call null, templateOptions\n        @$el.html render\n        @afterRender()\n\n        @\n\n    beforeRender: ->\n\n    afterRender: ->\n\n    destroy: ->\n        @undelegateEvents()\n        @$el.removeData().unbind()\n        @remove()\n        Backbone.View::remove.call @","BaseView = require 'lib/base_view'\n\n# View that display a collection of subitems\n# used to DRY views\n# Usage : new ViewCollection(collection:collection)\n# Automatically populate itself by creating a itemView for each item\n# in its collection\n\n# can use a template that will be displayed alongside the itemViews\n\n# itemView       : the Backbone.View to be used for items\n# itemViewOptions : the options that will be passed to itemViews\n# collectionEl : the DOM element's selector where the itemViews will\n#                be displayed. Automatically falls back to el if null\n\nmodule.exports = class ViewCollection extends BaseView\n\n    itemview: null\n\n    views: {}\n\n    template: -> ''\n\n    itemViewOptions: ->\n\n    collectionEl: null\n\n    \n    # add 'empty' class to view when there is no subview\n    onChange: ->\n        @$el.toggleClass 'empty', _.size(@views) is 0\n\n    # can be overriden if we want to place the subviews somewhere else\n    appendView: (view) ->\n        @$collectionEl.append view.el\n\n    # bind listeners to the collection\n    initialize: ->\n        @count = 0\n        @deleted = 0\n        super\n        @views = {}\n        @listenTo @collection, \"reset\",   @onReset\n        @listenTo @collection, \"add\",     @addItem\n        @listenTo @collection, \"remove\",  @removeItem\n\n        if not @collectionEl?\n            collectionEl = el\n\n    # if we have views before a render call, we detach them\n    render: ->\n        view.$el.detach() for id, view of @views\n        super\n\n    # after render, we reattach the views\n    afterRender: ->\n        @$collectionEl = $(@collectionEl)\n        @appendView view.$el for id, view of @views\n        @onReset @collection\n        @onChange @views\n\n    # destroy all sub views before remove\n    remove: ->\n        @onReset []\n        super\n\n    # event listener for reset\n    onReset: (newcollection) ->\n        view.remove() for id, view of @views\n        newcollection.forEach @addItem\n\n    # event listeners for add\n    addItem: (model) =>\n        @count++\n        model.set(\"count\", @count)\n        options = _.extend {}, {model: model}, @itemViewOptions(model)\n        view = new @itemview(options)\n        @views[model.cid] = view.render()\n        @appendView view\n        @onChange @views\n\n    # event listeners for remove\n    removeItem: (model) =>\n        @deleted++\n        @views[model.cid].remove()\n        delete @views[model.cid]\n\n        @onChange @views","module.exports = class DoctypeModel extends Backbone.Model\n\trootUrl: \"doctypes\"","module.exports = class ResultModel extends Backbone.Model\n\trootUrl: \"search\"\n\n\tmethodUrl : {\n\t\t'delete': '/delete'\n\t}\t\n\n\tsync : (method, model, options) -> \n\t\tif model.methodUrl and model.methodUrl[method.toLowerCase()]\n\t\t\toptions = options || {}\n\t\t\toptions.url = model.methodUrl[method.toLowerCase()]\n\t\t\toptions.type = 'get'\t\t\t\n\t\tBackbone.sync method, model, options","NavView = require 'views/nav_view'\nDoctypesView = require 'views/doctypes_view'\nDoctypeCollectionView = require 'views/doctype_collection_view'\nSearchView = require 'views/search_view'\nResultCollectionView = require 'views/result_collection_view'\n\nmodule.exports = class Router extends Backbone.Router\n    \n    routes:\n        '': 'doctypes'\n        'doctypes' : 'doctypes'\n        'search' : 'search'\n        'search/all/:doctype' : 'search'\n\n    redirectToDoctypes: ->\n        this.navigate(\"/doctypes\", true)\n\n    doctypes: ->\n        navView = new NavView()\n        doctypesView = new DoctypesView()\n        doctypesView.render()\t\n        dcView = new DoctypeCollectionView()\n        dcView.render()\n\n    search : (doctype) ->\n        navView = new NavView()\n        options = {}\n        if doctype?\n            options['range'] = 'all'\n            options['docType'] = doctype\n        searchView = new SearchView(options)\n        searchView.render()        ","ViewCollection = require '../lib/view_collection'\nDoctypeCollection = require '../collections/doctype_collection'\nDoctypeView = require './doctype_view'\n\nmodule.exports = class DoctypeCollectionView extends ViewCollection\n\t\n\titemview: DoctypeView\n\tcollection: new DoctypeCollection()\n\n\tinitialize: ->\n\t\t@collectionEl = '#doctypes-list'\n\t\tsuper\n\t\t@collection.fetch()\t\t\n\t\t@views = {}\n\t\t@listenTo @collection, \"reset\",   @onReset","View = require './../lib/view'\n\nmodule.exports = class DoctypeView extends View\n\n    tagName: 'tr'\n    className: 'doctype-list-item'\n\n    render: ->\n        super \n            name: @model.get(\"name\")\n            metadoctype : @model.get(\"metadoctype\")\n            sum : @model.get(\"sum\")\n            app : @model.get(\"app\")\n\n    template: ->\n        require './templates/doctype'\n\n    events : {\n        'click .more-info' : 'showDescription'\n    }\n\n\n    showDescription: (e) ->\n        jqObj = $(e.currentTarget)\n\n        #show description\n        if (jqObj.hasClass('label-primary'))  \n\n            #prepare elements          \n            descWrapper = jqObj.parent().children('.md-desc-wrapper')\n            newTd = $(document.createElement('td')).attr('colspan', '3')\n            newTr = $(document.createElement('tr')).addClass('bg-gray')\n\n            #tranform elements\n            descWrapper.appendTo(newTd).show()\n            newTd.appendTo(newTr)\n            jqObj.closest(\".\" + @className).after(newTr)\n\n            #change button\n            jqObj.removeClass('label-primary').addClass('label-danger').empty().append(' Hide info <i class=\"icon-minus-sign\"></i> ')\n        \n        #hide description\n        else \n            #prepare elements  \n            descWrapper = jqObj.closest(\".\" + @className).next(\"tr\").find('.md-desc-wrapper').hide()\n\n            #tranform elements\n            jqObj.parent().append(descWrapper)\n            jqObj.closest(\".\" + @className).next(\"tr\").remove()\n\n            #change button\n            jqObj.removeClass('label-danger').addClass('label-primary').empty().append(' More info <i class=\"icon-plus-sign\"></i> ')","BaseView = require '../lib/base_view'\n\nmodule.exports = class DoctypesView extends BaseView\n\n    el: '#content'    \n    template: require('./templates/doctypes')\n\n    \t","BaseView = require '../lib/base_view'\n\nmodule.exports = class NavView extends BaseView\n\n\tel: 'body.application'  \n\ttitles : {\n\t\t'' : '#doctypes'\n\t\t'doctypes' : '#doctypes'\n\t\t'search' : '#search'\n\t\t'searchAllByDoctype' : '#search'\n\t}\n\n\tinitialize:-> \n\t\tBackbone.history.on('route', (source, path) ->\n\t\t\t@render(path)\n\t\t, @)\n\n\trender : (path) ->\n\t\tthat = this\n\t\t$('.nav > li').each () ->\n\t\t\t$(this).removeClass('active')\n\t\t\t$(this).children('a').blur()\n\t\t\tif $(this).children('a').attr('href') is that.titles[path]\n\t\t\t\t$(this).addClass('active')\n\n","ViewCollection = require '../lib/view_collection'\nResultCollection = require '../collections/result_collection'\nResultView = require './result_view'\n\nmodule.exports = class ResultCollectionView extends ViewCollection\n\t\n\titemview: ResultView\t\n\tcollectionEl :'#basic-accordion'\n\tisLoading : false\n\tnoMoreItems : false\n\t\n\tinitialize: ->\t\n\t\tthat = this\n\t\t@collection = new ResultCollection()\n\t\tsuper\t\t\n\t\t@collection.fetch {\n\t\t\tdata: $.param(@options)\n\t\t\tsuccess : (col, data) ->\n\n\t\t\t\t#native size of the window could trigger next pages (infinite scroll)\n\t\t\t\tif that.options.range? and that.options.docType?\t\t\n\t\t\t\t\tif data.length is that.collection.nbPerPage\n\t\t\t\t\t\tthat.loopFirstScroll()\n\t\t\t\t\t\t$('.load-more-result').show()\n\t\t\t\t\t\t\n\t\t\t\t\telse \t\t\t\t\t\t\n\t\t\t\t\t\tthat.noMoreItems = true\n\t\t\t\t\t\t$('.load-more-result').hide()\n\t\t\terror : () ->\n\t\t\t\tthat.displayLoadingError()\n\n\t\t}\n\tloadNextPage : (isTriggered, callback) ->\t\t\t\t\n\t\tthat = this\n\t\t@options['deleted'] = @deleted\n\t\tif !@noMoreItems\t\t\t\n\t\t\t@isLoading = true\n\t\t\t@collection.page++\t\t\t\n\t\t\tif !isTriggered\n\t\t\t\t$('.load-more-result i, .load-more-result span').hide()\n\t\t\t\t$('.load-more-result').spin 'tiny'\n\t\t\t@collection.fetch {\n\t\t\t\tdata: $.param(@options)\n\t\t\t\tremove : false\n\t\t\t\tsuccess : (col, data) ->\n\t\t\t\t\tif !isTriggered\n\t\t\t\t\t\t$('.load-more-result .spinner').hide()\n\t\t\t\t\t\t$('.load-more-result i, .load-more-result span').show()\t\t\t\t\t\n\t\t\t\t\tthat.noMoreItems = data.length < that.collection.nbPerPage\n\t\t\t\t\tif that.noMoreItems \n\t\t\t\t\t\t$('.load-more-result').hide()\n\t\t\t\t\tthat.isLoading = false\n\t\t\t\t\tif callback?\n\t\t\t\t\t\tcallback()\t\t\t\t\t\t\n\t\t\t\terror : () ->\n\t\t\t\t\tthat.displayLoadingError()\n\t\t\t}\n\tloopFirstScroll : ()->\n\t\tthat = this\n\t\tif !@isLoading and !@noMoreItems\t\t\t\n\t\t\tfirstScroll = $(document).height() is $(window).height()\t\t\t\n\t\t\tif (firstScroll)\n\t\t\t\t@loadNextPage true, () ->\n\t\t\t\t\tthat.loopFirstScroll()\n\n\tdisplayLoadingError : () ->\n\t\t$('.load-more-result').css({'color' : '#AF4434'})\n\t\t$('.load-more-result i').hide()\n\t\t$('.load-more-result span').text('An error occurs during the loading process')\n\t\t$('.load-more-result').show()","View = require './../lib/view'\n\nmodule.exports = class ResultView extends View\n\n\ttagName: 'div'\n\tclassName: 'accordion-group'\n\n\trender: ->\n\t\tthat = this\n\t\tsuper\n\t\t\tresults : that.manageResultsForView @model.attributes, @model.get(\"count\")\n\n\tmanageResultsForView: (attr, count) ->\n\t\tresults = {}\n\n\t\t#case no results\n\t\tif attr.no_result?\n\t\t\t$('#all-result .accordion').empty()\n\t\t\tresults['no_result'] = true\n\t\t\treturn results\n\n\t\t#prepare results\n\t\telse\n\n\t\t\t#no_result\n\t\t\tresults['no_result'] = false\t\n\n\t\t\t#count\t\t\n\t\t\tresults['count'] = count\t\t\t\n\n\t\t\t#heading\n\t\t\tresults['heading'] = {\n\t\t\t\t'field' : if attr.idField? then attr.idField else 'id'\n\t\t\t\t'data' : if attr.idField? then attr[attr.idField] else attr._id\n\t\t\t}\t\n\n\t\t\t#fields\n\t\t\tresults['fields'] = []\n\t\t\tiCounter = 0\n\n\t\t\tfor field of attr\n\n\t\t\t\tif field isnt 'idField' and field isnt 'count' and field isnt 'descField'\n\t\t\t\t\t\n\t\t\t\t\t#prepare new fields\n\t\t\t\t\tresults['fields'][iCounter] = {\n\t\t\t\t\t\t'cdbFieldDescription' : \"\"\n\t\t\t\t\t\t'cdbFieldName' : field\n\t\t\t\t\t\t'cdbFieldData' : \"\"\n\t\t\t\t\t\t'cdbLabelClass' : \"label-secondary\"\n\t\t\t\t\t}\n\n\t\t\t\t\t#add description and name\t\t\t\t\n\t\t\t\t\tif attr.descField? and attr.descField[field]?\n\t\t\t\t\t\tif attr.descField[field].description?\n\t\t\t\t\t\t\tresults['fields'][iCounter]['cdbFieldDescription'] = attr.descField[field].description\n\t\t\t\t\t\t\n\t\t\t\t\t\tif attr.descField[field].displayName? and attr.descField[field].displayName isnt \"\"\n\t\t\t\t\t\t\tresults['fields'][iCounter]['cdbFieldName'] = attr.descField[field].displayName\n\t\t\t\t\t\t\tif field is results['heading']['field']\n\t\t\t\t\t\t\t\tresults['heading']['field'] = attr.descField[field].displayName\n\n\t\t\t\t\t#add data according to typeof\t\t\n\t\t\t\t\t#field isn't an object\t: display text\n\t\t\t\t\tif typeof attr[field] is 'string' or typeof attr[field] is 'number' or typeof attr[field] is 'boolean'\n\t\t\t\t\t\tresults['fields'][iCounter]['cdbFieldData'] = attr[field]\n\n\t\t\t\t\t#field is an object : display list\n\t\t\t\t\telse if attr[field]? and typeof attr[field] is 'object'\t\n\t\t\t\t\t\tresults['fields'][iCounter]['cdbFieldData'] = '<ul class=\"sober-list\">'\t\t\t\t\t\t \n\t\t\t\t\t\tfor obj of attr[field]\n\t\t\t\t\t\t\tif typeof attr[field][obj] is 'string' or typeof attr[field][obj] is 'number' or typeof attr[field][obj] is 'boolean'\n\t\t\t\t\t\t\t\tresults['fields'][iCounter]['cdbFieldData'] += '<li>' + obj + ' : <i>' + attr[field][obj] + '</i></li>'\n\t\t\t\t\t\t\telse if attr[field][obj]? and typeof attr[field][obj] is 'object'\n\t\t\t\t\t\t\t\tresults['fields'][iCounter]['cdbFieldData'] += '<li>' + obj + ' : <i>' + $.stringify(attr[field][obj]) + '</i></li>'\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\tresults['fields'][iCounter]['cdbFieldData'] += '<li><i>empty</i></li>'\n\t\t\t\t\t\t\t\tresults['fields'][iCounter]['cdbLabelClass'] = 'label-danger'\n\t\t\t\t\t\tresults['fields'][iCounter]['cdbFieldData'] += '</ul>'\n\t\t\t\t\telse\n\t\t\t\t\t\tresults['fields'][iCounter]['cdbFieldData'] = '<i>empty</i>'\n\t\t\t\t\t\tresults['fields'][iCounter]['cdbLabelClass'] = 'label-danger'\n\t\t\t\t\t\t\n\t\t\t\tiCounter++\n\t\n\t\t\treturn results\n\n\n\ttemplate: ->\n\t\trequire './templates/result'\n\n\ttemplateModal: require('./templates/modal_confirm')\n\n\tevents : {\n\t\t'click .accordion-toggle' : 'blurIt'\n\t\t'mouseenter .label' : 'showFieldDescription'\n\t\t'mouseleave .label' : 'showFieldDescription'\n\t\t'click .remove-result' : 'confirmRemoveResult'\n\t}\n\tblurIt : (e) ->\n\t\t$(e.currentTarget).blur()\n\n\tshowFieldDescription : (e) ->\n\t\tjqObj = $(e.currentTarget)\n\t\tif jqObj.attr(\"data-title\") isnt \"\"\n\t\t\tif e.type is 'mouseenter'\n\t\t\t\t\n\t\t\t\tleft = jqObj.offset().left - $('#basic-accordion.accordion').offset().left - 5\n\t\t\t\ttop = jqObj.offset().top - $('#basic-accordion.accordion').offset().top - 7\n\t\t\t\t$('.info-box .field-title').css({'padding-left' : jqObj.width() + 18})\n\t\t\t\t$('.info-box .field-description').empty().html(jqObj.attr(\"data-title\"))\t\t\n\t\t\t\t$('.info-box').css({'z-index' : '5', 'left' : left , 'top' : top})\n\t\t\t\t$('.accordion .label').css({'z-index' : 'inherit'})\n\t\t\t\tjqObj.css({'z-index' : '10'})\n\t\t\t\t$('.info-box').stop().fadeTo(200, 1);\n\t\t\telse\n\t\t\t\t$('.info-box').stop().fadeTo(200, 0);\n\n\tconfirmRemoveResult : (e) ->\n\t\tthat = this\n\t\te.preventDefault()\n\t\n\t\tdata =\n\t\t\ttitle: 'Confirmation required'\n\t\t\tbody: 'Are you sure ? This can\\'t be undone, and will erase definitly the data from the database.'\n\t\t\tconfirm: 'delete permanently'\n\n\t\t$(\"body\").prepend @templateModal(data)\n\t\t$(\"#confirmation-dialog\").modal()\n\t\t$(\"#confirmation-dialog\").modal(\"show\")\n\t\t$(\"#confirmation-dialog-confirm\").bind \"click\", ()->\n\t\t\tthat.removeResult()\n\t\n\tremoveResult : () ->\n\n\t\t#set id for the native backbone delete action\n\t\t@model.set('id', @model.get('_id'))\n\n\t\t#remove\n\t\t@model.destroy {\n\t\t\tdata : 'id=' + @model.get('id')\t\t\t\t\n\t\t}\n\t\t$(window).resize()","BaseView = require '../lib/base_view'\nResultCollectionView = require '../views/result_collection_view'\n\nmodule.exports = class SearchView extends BaseView\n\n\tel: '#content'    \n\ttemplate: require('./templates/search')  \n\n\tinitialize : ->\n\t\tthat = this\n\t\t@rcView = new ResultCollectionView(@options)\t\t\n\n\t\t#scroll event trigger next page (infinite scroll)\n\t\tif @options.range?\n\t\t\t$(window).bind 'scroll', (e, isTriggered) ->\n\t\t\t\tif !that.rcView.isLoading and !that.rcView.noMoreItems\n\t\t\t\t\tif $(window).scrollTop() + $(window).height() is $(document).height()\n\t\t\t\t\t\tthat.loadMore(isTriggered)\n\n\tafterRender : ->\n\t\tthat = this\n\t\t@rcView.render()\n\n\t\t#resize event trigger 1 or + pages (infinite scroll)\n\t\t$(window).bind 'resize', () ->\n\t\t\tthat.rcView.loopFirstScroll()\n\n\t\t\n\tloadMore : (isTriggered)->\t\n\t\t@rcView.loadNextPage(isTriggered)","td.full.firstLetterUp\n\ta(href='#search/all/#{name}') #{name}\ntd\n\t- if (typeof(sum) === 'number'){\n\t\tspan #{sum}\n\t- }\ntd \n\t- if (typeof(metadoctype) === 'object' || app.length > 0){\n\t\tspan.label.label-primary.more-info More info \n\t\t\ti.icon-plus-sign \n\t\tdiv.md-desc-wrapper\n\t\t\th5 \n\t\t\t\ti.icon-question-sign \n\t\t\t\t|&nbsp;&nbsp;About #{name}\n\t\t\t- if (app.length > 0) {\n\t\t\t\tdiv.md-desc-container\n\t\t\t\t\tstrong Applications using it :\n\t\t\t\t\tul.sober-list\n\t\t\t\t\t\t- for (var index in app) {\n\t\t\t\t\t\t\tli.firstLetterUp\n\t\t\t\t\t\t\t\ti.icon-download-alt\n\t\t\t\t\t\t\t\tspan #{app[index]}\n\t\t\t\t\t\t- }\n\t\t\t-}\n\t\t\t- if (typeof(metadoctype) === 'object') {\n\t\t\t\tdiv.md-desc-container\n\t\t\t\t\tstrong Fields informations :\n\t\t\t\t\tul.sober-list\n\t\t\t\t\t\t- var fields = metadoctype.fields[0];\n\t\t\t\t\t\t- for (var obj in fields) {\n\t\t\t\t\t\t\tli\n\t\t\t\t\t\t\t\ti.icon-tag\n\t\t\t\t\t\t\t\tspan #{fields[obj].displayName} - \n\t\t\t\t\t\t\t\t\ti #{fields[obj].description} \n\t\t\t\t\t\t- }\n\t\t\t- }\n\t- }\n\t- else {\n\t\ti No information available\n\t- }\n\n","#masthead\n\t.container\n\t\t.masthead-pad            \n\t\t\t.masthead-text\n\t\t\t\th2 Doctypes\n\t\t\t\tp Here you can find the full list of document types present on your cozy\n.container\n\t.row\n\t\t.span12\n\t\t\th3.title My current doctype list\t\n\t\t.span11.offset1\t\n\t\t\t#doctypes-container\n\t\t\t\ttable.table\n\t\t\t\t\tthead\t\t\t\t\t\t\n\t\t\t\t\t\tth Name\n\t\t\t\t\t\tth Number of documents\n\t\t\t\t\t\tth About that doctype\n\t\t\t\t\ttbody#doctypes-list\n","#confirmation-dialog.modal\n  .modal-dialog\n    .modal-content\n      .modal-header\n        button.close(type='button', data-dismiss='modal', aria-hidden='true') x\n        h4.modal-title\n          | #{title}\n      .modal-body\n        p\n          | #{body}\n      .modal-footer\n        span.btn.btn-link(data-dismiss='modal') cancel\n        span#confirmation-dialog-confirm.btn.btn-cozy(data-dismiss='modal') #{confirm}","- if (results['no_result']) {\n\nem No results for now.\n\n- }\n- else {\n\n.accordion-heading\n\ta.accordion-toggle(data-toggle=\"collapse\", data-parent=\"#basic-accordion\", href=\"#collapse#{results.count}\")\n\t\ti.icon-plus-sign\n\t\t|&nbsp;#{results.heading.field} :\n\t\t|&nbsp;#{results.heading.data}\n\tdiv.remove-result Remove&nbsp;&nbsp;\n\t\ti.icon-remove-sign\n.accordion-body.collapse(style=\"height: 0px;\", id=\"collapse#{results.count}\")\n\t.accordion-inner\n\t\ttable.table#result-list\n\t\t\t- for (var iCount = 0; iCount < results['fields'].length; iCount++) {\n\t\t\t\ttr \t\n\t\t\t\t\ttd \n\t\t\t\t\t\tspan.label(class=\"#{results['fields'][iCount].cdbLabelClass}\", data-title=\"#{results['fields'][iCount].cdbFieldDescription}\") &nbsp;#{results['fields'][iCount].cdbFieldName}&nbsp; \n\t\t\t\t\t\t\t- if (results['fields'][iCount].cdbFieldDescription!== \"\") {\n\t\t\t\t\t\t\t\ti.icon-question-sign\n\t\t\t\t\t\t\t-}\n\t\t\t\t\ttd!= results['fields'][iCount].cdbFieldData\n\t\t\t- }\n- }","#masthead\n\t.container\n\t\t.masthead-pad            \n\t\t\t.masthead-text\n\t\t\t\th2 Search Engine\n\t\t\t\tp Here you can prepare and launch your search\n.container\n\t.row\n\t\t.span12\t\t\n\t\t\th3.title Results of my previous search\n\t\t\t#all-result\n\t\t\t\t#basic-accordion.accordion\n\t\t\t\t.info-box\n\t\t\t\t\tspan.field-title &nbsp;About this field\n\t\t\t\t\tspan.field-description\n\t\t\t\t\t\tem no information\n\t\t\t\tdiv.load-more-result \n\t\t\t\t\tspan load more results&nbsp\n\t\t\t\t\tbr\n\t\t\t\t\ti.icon-circle-arrow-down"]}