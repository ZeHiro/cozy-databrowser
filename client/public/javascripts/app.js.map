{"version":3,"sources":["app/application.js","app/initialize.js","app/models/menu.js","app/views/main.js","app/views/menu.js"],"names":[],"mappings":"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","file":"public/javascripts/app.js","sourcesContent":["import MenuView from \"views/menu\";\nimport MainView from \"views/main\";\n\nvar Router = Backbone.Router.extend({\n    routes: {\n        \"doctype/:doctype\": \"onDoctype\"\n    },\n    onDoctype(doctype){\n        this.app.views.main.setDoctype(doctype);\n        this.app.views.menu.select(doctype);\n    }\n});\n\nvar app = {\n    initialize() {\n        this.views = {\n            menu: new MenuView(),\n            main: new MainView()\n        };\n        this.views.menu.$el.appendTo(\"#container\");\n        this.views.main.$el.appendTo(\"#container\");\n        this.router = new Router({\n            app: this\n        });\n        this.router.app = this;\n        Backbone.history.start();\n\n        $(\"[formaction='drawer/toggle']\").on(\"click\", () => {\n            const $aside = $(\"aside\")\n            const isExpanded = $aside.attr(\"aria-expanded\") === \"true\" ? \"false\" : \"true\";\n            $aside.attr(\"aria-expanded\", isExpanded);\n        });\n    }\n}\n\nvar router = new Router();\n\nexport default app\n\n","import app from \"application\";\n\nwindow.app = app;\n\n$(() => app.initialize());\n","export default Backbone.Collection.extend({\n    model: Backbone.Model,\n    url: \"doctypes\"\n});\n","function attrToString(attr) {\n    if (!_(attr).isObject()) return attr;\n    else {\n        let result = '<ul>';\n        for (let i in attr) {\n            result+= `<li>${attrToString(attr[i])}</li>`;\n        }\n        result+= '</ul>';\n        return result;\n    }\n}\n\nexport default Backbone.View.extend({\n    el: \"[role='contentinfo']\",\n    collection: new Backbone.Collection(),\n    initialize() {\n        this.$el.html('<table></table>');\n        this.listenTo(this.collection, \"reset\", this.render);\n    },\n    getCols(json) {\n        var result = [];\n        if (json.length === 0) return result;\n        for (var i in json[0]) {\n            result.push({\n                title: i,\n                data: i,\n                defaultContent: \"\"\n            });\n        }\n        return result;\n    },\n    render() {\n        var json = this.collection.toJSON();\n        var config = {\n            destroy: true,\n            lengthChange: false,\n            paging: false,\n            dom: \"fit\",\n            data: json,\n            columns: this.getCols(json)\n        };\n        this.$(\"table\").DataTable(config);\n        return this;\n    },\n    setDoctype(doctype){\n        this.doctype = doctype;\n        this.collection.fetch({\n            reset: true,\n            url: \"search?range=all&doctypes[]=\" + doctype\n        });\n    }\n});\n","import Collection from \"models/menu\";\n\nexport default Backbone.View.extend({\n    el: \"aside\",\n    collection: new Collection(),\n    initialize() {\n        this.collection.fetch().done(this.render.bind(this));\n    },\n    itemTemplate: _.template('<li><a class=\"<%= sclass %>\" href=\"#doctype/<%= doctype %>\"><%= doctype %> (<%= sum %>)</a></li>'),\n    render() {\n        var html = \"<ul>\";\n        this.collection.forEach((model) => {\n            var json = model.toJSON();\n            json.sclass = json.doctype === this.selected ? \"selected\" : \"\";\n            html+= this.itemTemplate(json);\n        }, this);\n        html+= \"</ul>\";\n        this.$el.empty().html(html);\n        return this;\n    },\n    select(doctype) {\n        this.selected = doctype;\n        this.$(\"a\").removeClass(\"selected\");\n        this.$(\"a[href='#doctype/\" + doctype + \"']\").addClass(\"selected\");\n    }\n});\n"]}